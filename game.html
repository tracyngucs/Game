<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Appointed Time</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: sans-serif;
    margin: 0;
    background: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  /* HOME SCREEN */
  #homeScreen {
    text-align: center;
  }

  #homeScreen input {
    padding: 12px;
    font-size: 20px;
    width: 280px;
    margin-bottom: 15px;
    border-radius: 8px;
    border: 1px solid #aaa;
  }

  #startButton {
    padding: 14px 30px;
    font-size: 22px;
    background: #0077cc;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
  }

  /* GAME SCREEN */
  #gameScreen {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  #timerButton {
    width: 300px;
    height: 300px;
    border-radius: 150px;
    background: linear-gradient(to bottom, #ff4d4d, #b30000);
    color: white;
    font-size: 48px;
    border: none;
    cursor: pointer;
    box-shadow: 0 10px 20px rgba(0,0,0,0.4), 0 4px 6px rgba(0,0,0,0.2);
    transition: transform 0.1s, box-shadow 0.1s;
  }

  #timerButton:active {
    transform: translateY(4px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.4);
  }

  #timeDisplay {
    margin-top: 20px;
    font-size: 48px;
  }

  #triesDisplay {
    margin-top: 15px;
    font-size: 28px;
  }

  #message {
    margin-top: 10px;
    font-size: 26px;
    color: #333;
  }

  #summaryBox {
    margin-top: 20px;
    padding: 15px;
    width: 80%;
    max-width: 400px;
    max-height: 300px;
    overflow-y: auto;
    border: 2px solid #444;
    border-radius: 10px;
    font-size: 20px;
    background: #f7f7f7;
    display: none;
  }

  #playerInfo {
    margin-bottom: 20px;
    font-size: 22px;
  }

  #playerChoice {
    display: none;
    margin-top: 20px;
  }

  #playerChoice button {
    margin: 0 10px;
    padding: 10px 20px;
    font-size: 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #0077cc;
    color: white;
  }

  #playerChoice button:hover {
    background: #005fa3;
  }
</style>
</head>
<body>

<!-- HOME SCREEN -->
<div id="homeScreen">
  <h1>Appointed Time</h1>
  <input type="text" id="playerName" placeholder="Enter Name" /><br>
  <input type="tel" id="playerMobile" placeholder="Enter Mobile Number" /><br>
  <button id="startButton">Start Now</button>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen">
  <div id="playerInfo"></div>

  <button id="timerButton">Start</button>
  <div id="timeDisplay">0.000 s</div>
  <div id="triesDisplay">Tries: 0 / 10</div>
  <div id="message"></div>
  <div id="summaryBox"></div>

  <div id="playerChoice">
    <span>Play as:</span>
    <button id="samePlayerBtn">Same Player</button>
    <button id="nextPlayerBtn">Next Player</button>
  </div>
</div>

<!-- BUZZ SOUND -->
<audio id="buzzSound" preload="auto">
  <source src="fail-buzzer-04.wav" type="audio/wav">
</audio>

<script>
let running = false;
let startTime = 0;
let tries = 0;
let results = []; // full history for current player
let allPlayers = {}; // all players' historical results

let playerNameValue = "";
let playerMobileValue = "";

const timerButton = document.getElementById('timerButton');
const display = document.getElementById('timeDisplay');
const triesDisplay = document.getElementById('triesDisplay');
const message = document.getElementById('message');
const summaryBox = document.getElementById('summaryBox');

const homeScreen = document.getElementById('homeScreen');
const gameScreen = document.getElementById('gameScreen');
const startButton = document.getElementById('startButton');
const playerInfo = document.getElementById('playerInfo');

const playerChoice = document.getElementById('playerChoice');
const samePlayerBtn = document.getElementById('samePlayerBtn');
const nextPlayerBtn = document.getElementById('nextPlayerBtn');
const buzz = document.getElementById('buzzSound');

// ⭐ HOME SCREEN → GAME START
startButton.addEventListener("click", () => {
    playerNameValue = document.getElementById("playerName").value.trim();
    playerMobileValue = document.getElementById("playerMobile").value.trim();

    if (!playerNameValue || !playerMobileValue) {
        alert("Please enter both name and mobile number.");
        return;
    }

    playerInfo.innerHTML = `<b>Player:</b> ${playerNameValue}`;
    homeScreen.style.display = "none";
    gameScreen.style.display = "flex";

    if (!allPlayers[playerNameValue]) {
        allPlayers[playerNameValue] = [];
    }
});

// ⭐ GAME LOGIC
timerButton.addEventListener('click', () => {

  if (tries >= 10 && timerButton.textContent === "Reset") {
      tries = 0;
      triesDisplay.textContent = "Tries: 0 / 10";
      message.textContent = "";
      summaryBox.style.display = "none";
      document.body.style.backgroundColor = "white";
      timerButton.textContent = "Start";

      // clear results in this choice screen
      display.textContent = "0.000 s";

      // Show choice for same/next player
      playerChoice.style.display = "block";
      return;
  }

  if (tries >= 10) return;

  if (!running) {
    running = true;
    startTime = performance.now();
    display.textContent = "0.000 s";
    timerButton.textContent = "Stop";
    document.body.style.backgroundColor = "white";
    requestAnimationFrame(updateTimer);

  } else {
    running = false;
    tries++;

    const elapsed = (performance.now() - startTime) / 1000;
    const formatted = parseFloat(elapsed.toFixed(3));
    results.push(formatted);
    allPlayers[playerNameValue].push(formatted);

    display.textContent = formatted.toFixed(3) + " s";
    triesDisplay.textContent = "Tries: " + tries + " / 10";

    if (formatted === 3.000) {
        document.body.style.backgroundColor = "green";
        timerButton.textContent = "You Win!";
    } else {
        document.body.style.backgroundColor = "red";
        timerButton.textContent = "Try Again";

        // play buzz sound
        buzz.currentTime = 0;
        buzz.play();
    }

    if (tries >= 10) {
        timerButton.textContent = "Reset";
        message.textContent = "Thanks for playing!";
        showSummary();
    }
  }
});

function updateTimer() {
  if (running) {
    const elapsed = (performance.now() - startTime) / 1000;
    display.textContent = elapsed.toFixed(3) + " s";
    requestAnimationFrame(updateTimer);
  }
}

function showSummary() {
    if (results.length === 0) return;

    let best = results.reduce((a, b) => {
        return Math.abs(a - 3) < Math.abs(b - 3) ? a : b;
    });

    let list = "";
    results.forEach((t, i) => {
        list += `Try ${i+1}: ${t.toFixed(3)}s / 3.000s<br>`;
    });

    summaryBox.innerHTML =
        `<b>Summary of All Tries (${playerNameValue})</b><br><br>
         ${list}<br>
         <b>Best Time:</b> ${best.toFixed(3)}s / 3.000s`;

    summaryBox.style.display = "block";
}

// ⭐ SAME PLAYER → restart game, retain history
samePlayerBtn.addEventListener('click', () => {
  playerChoice.style.display = "none";
  tries = 0;
  triesDisplay.textContent = "Tries: 0 / 10";
  message.textContent = "";
  display.textContent = "0.000 s";
  timerButton.textContent = "Start";
  summaryBox.style.display = "block"; // show full history
});

// ⭐ NEXT PLAYER → reset all, start fresh
nextPlayerBtn.addEventListener('click', () => {
  playerChoice.style.display = "none";
  homeScreen.style.display = "block";
  gameScreen.style.display = "none";
  results = [];
  tries = 0;
  document.getElementById("playerName").value = "";
  document.getElementById("playerMobile").value = "";
});
</script>

</body>
</html>
