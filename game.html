<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>3 Second Reflex Game</title>
<style>
  :root{--btn-size:270px;}
  html,body{height:100%;margin:0}
  body{
    display:flex;
    align-items:center;
    justify-content:center;
    flex-direction:column;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background:#fff;
  }
  #timerButton{
    width:var(--btn-size);
    height:var(--btn-size);
    border-radius:50%;
    background:linear-gradient(to bottom,#ff4d4d,#b30000);
    color:#fff;
    font-size:48px;
    border:none;
    cursor:pointer;
    box-shadow:0 12px 26px rgba(0,0,0,0.35), 0 6px 10px rgba(0,0,0,0.18);
    transition:transform .08s, box-shadow .08s;
    display:flex;
    align-items:center;
    justify-content:center;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
  }
  #timerButton:active{
    transform: translateY(5px);
    box-shadow:0 6px 10px rgba(0,0,0,0.4);
  }
  #timeDisplay{margin-top:18px;font-size:48px}
  #triesDisplay{margin-top:12px;font-size:22px;color:#222}
  #message{margin-top:10px;font-size:20px;color:#333}
  @media (max-width:420px){
    :root{--btn-size:320px} /* bigger on small phones if wanted */
    #timerButton{font-size:54px}
    #timeDisplay{font-size:64px}
  }
</style>
</head>
<body>

<button id="timerButton">Start</button>
<div id="timeDisplay">0.000 s</div>
<div id="triesDisplay">Tries: 0 / 10</div>
<div id="message"></div>

<!-- Arcade WIN sound (short chime) -->
<audio id="winSound" preload="auto">
  <source type="audio/wav" src="data:audio/wav;base64,UklGRmAwAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YTwwAAAAAgCAsJ6dX1tqZmZqZ2dnd3d3c3Nzc2tra2tra2tra2tra2tra2tra2tra2tqampqamppaWlpZmVmZWRkZGRjY2NjY2JiYmJiYmBgYGBgX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw==">
</audio>

<!-- Buzz LOSE sound (short buzzer) -->
<audio id="failSound" preload="auto">
  <source type="audio/wav" src="data:audio/wav;base64,UklGRkZWAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YSJWAAAAAgD9/f3+/v7+/v7+/v39/f3+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+">
</audio>

<script>
(() => {
  const button = document.getElementById('timerButton');
  const display = document.getElementById('timeDisplay');
  const triesDisplay = document.getElementById('triesDisplay');
  const message = document.getElementById('message');
  const winSound = document.getElementById('winSound');
  const failSound = document.getElementById('failSound');

  let running = false;
  let startTime = 0;
  let tries = 0;
  let rafId = null;

  function formatMs(ms){ return (ms/1000).toFixed(3) + ' s'; }

  function updateTimer(){
    if(!running) return;
    const elapsed = performance.now() - startTime;
    display.textContent = (elapsed/1000).toFixed(3) + ' s';
    rafId = requestAnimationFrame(updateTimer);
  }

  button.addEventListener('click', async () => {
    // If we've hit max tries and button shows Reset, reset state
    if(tries >= 10 && button.textContent.trim().toLowerCase() === 'reset'){
      tries = 0;
      display.textContent = '0.000 s';
      triesDisplay.textContent = 'Tries: 0 / 10';
      message.textContent = '';
      document.body.style.backgroundColor = '#fff';
      button.textContent = 'Start';
      return;
    }

    // Prevent extra clicks after 10 tries (before reset)
    if(tries >= 10) return;

    if(!running){
      // start
      running = true;
      startTime = performance.now();
      display.textContent = '0.000 s';
      button.textContent = 'Stop';
      document.body.style.backgroundColor = '#fff';
      rafId = requestAnimationFrame(updateTimer);
      // Ensure sounds are loaded so Safari considers them user-initiated
      try{ await winSound.play().then(()=>winSound.pause(), ()=>{}); }catch(e){}
      try{ await failSound.play().then(()=>failSound.pause(), ()=>{}); }catch(e){}
    } else {
      // stop
      running = false;
      if(rafId) cancelAnimationFrame(rafId);
      const elapsed = (performance.now() - startTime) / 1000;
      const formatted = elapsed.toFixed(3);
      display.textContent = formatted + ' s';

      tries++;
      triesDisplay.textContent = 'Tries: ' + tries + ' / 10';

      if(formatted === '3.000'){
        document.body.style.backgroundColor = '#0bbf4a';
        // play win sound (reset to start)
        winSound.currentTime = 0;
        winSound.play().catch(()=>{ /* play may be blocked if not gesture, but it's user gesture here */ });
        button.textContent = 'You Win!';
      } else {
        document.body.style.backgroundColor = '#e33d3d';
        failSound.currentTime = 0;
        failSound.play().catch(()=>{});
        button.textContent = 'Try Again';
      }

      if(tries >= 10){
        message.textContent = 'Thanks for playing!';
        button.textContent = 'Reset';
        // lock further attempts until reset
        running = false;
      }
    }
  });
})();
</script>

</body>
</html>
